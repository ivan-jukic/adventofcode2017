module Puzzles.Day19 exposing (..)

import Components.View exposing (puzzleView, partData)
import Html exposing (..)
import Html.Attributes exposing (..)
import Utils exposing (..)
import Matrix exposing (Matrix)


{-|
-}
type Msg
    = NoOp


{-|
-}
type alias Model = 
    {}


initialModel : ( Model, Cmd Msg )
initialModel =
    ( {}, Cmd.none )


{-|
-}
update : Msg -> Model -> ( Model, Cmd Msg )
update msg model =
    case msg of
        NoOp ->
            ( model, Cmd.none )


{-|
-}
view : Model -> Html Msg
view model =
    div [ class "solution solution-19" ]
        [ puzzleView
            "Task title"
            [ { partData
                | label = "19 A Series of Tubes"
                , desc = "Path on the way out: "
                , button = Nothing
                , buttonLabel = Nothing
                , solution = Nothing
                }
            , { partData
                | label = "2) Second part"
                , desc = "Solution for this part of the puzzle: "
                , button = Nothing
                , buttonLabel = Nothing
                , solution = Nothing
                }
            ]
        ]


{-|
-}
type Direction
    = Up
    | Down
    | Right
    | Left


{-|
-}
followPath : Matrix.Location -> Direction -> Matrix String -> String
followPath (i, j) dir mat =
    case Matrix.get loc mat of
        Just c ->
            let
                ( nextLoc, nextDir ) =
                    case c of
                        "+" ->

                        _ ->
                            case dir of
                                Up ->
                                    ( i + 1, j )

                                Down ->
                                    ( i - 1, j )

                                Right ->
                                    ( i, j + 1 )

                                Left ->
                                    ( i, j - 1 )
            in
            case c of
                if c == "-" || c == "|" then



                else if c == "+" then


                else if Regex.contains (regex "[A-Za-z]") c then ->

                
                else ->
                    ""

        Nothing ->
            ""


{-|
-}
processInput : (Matrix String, Matrix.Location)
processInput =
    let
        lines =
            String.lines inputStr

        rows =
            List.length lines

        cols =
            lines |> List.foldl (\l c -> if String.length l > c then String.length l else c) 0

        start =
            lines
                |> List.head
                |> Maybe.andThen
                    (\ln -> ln |> String.split "" |> List.indexedMap (,) |> List.foldl (\(i, v) c -> if (String.trim v) /= "" then i else c) 0 |> Just)
                |> Maybe.withDefault 0

        emptyMat =
            Matrix.matrix rows cols (\_ -> "")

        mat =
            lines
                |> List.indexedMap (,)
                |> List.foldl
                    (\(i, ln) m ->
                        ln
                            |> String.split ""
                            |> List.indexedMap (,)
                            |> List.foldl
                                (\(j, c) m -> Matrix.set (i, j) (String.trim c) m) m
                    )
                    emptyMat

        _ = Debug.log "" (Matrix.toList mat, start)
    in
    (mat, (0, start))


{-|
-}
inputStr : String
inputStr =
    """     |          
     |  +--+    
     A  |  C    
 F---|----E|--+ 
     |  |  |  D 
     +B-+  +--+ """
 {-- }
    """                                                                                                   |                                                                                                     
 +-------------------+               +-+ +-------+       +-------------------+                     |                                         +---+                                   +-----+       +---+ 
 |                   |               | | |       |       |                   |                     |                                         |   |                                   |     |       |   | 
 |         +---+     |   +---------------|-------|-----------------------+ +-----------------------------+                                   |   |                                   |     |       |   | 
 |         |   |     |   |           | | |       |       |               | | |                     |     |                                   |   |                                   |     |       |   | 
 |         |   +---------------------|-----------------------------------|-------------------------------------------------------------------|-----------------+           +-----------------------+   | 
 |         |         |   |           | | |       |       |               | | |                     |     |                                   |   |             |           |         |     |           | 
 |         |         |   +-------------|-|---------------|---------------|---|---------------------------|-------------------------+         |   |             |         +-|---------|-------------+   | 
 |         |         |               | | |       |       |               | | |                     |     |                         |         |   |             |         | |         |     |       |   | 
 |   +-------------------------------|-----------|-------|---------------|---|---------------------|-----|-----------------------------------|---|-------------+ +-------+ |         +-----|---+   |   | 
 |   |     |         |               | | |       |       |               | | |                     |     |                         |         |   |               |         |               |   |   |   | 
 |   +-+   |         |               | | |       |       |               +-+ |                     |     | +---------------------------------|---|---------------+         |               |   |   | +-+ 
 |     |   |         |               | | |       |       |                   |                     |     | |                       |         |   |                         |               |   |   | |   
 |     |   |         |               | | |   +---|-------|-------------------|---------------------|-----|-|---------------------------+     | +-|-------------+           | +-----+       |   |   | |   
 |     |   |         |               | | |   |   |       |                   |                     |     | |                       |   |     | | |             |           | |     |       |   |   | |   
 | +---|-------------------------------|-|---------------|---------------+   |                   +---------------------+           +-------+ +-|-|-------------------------|-|-----|---------------|---+ 
 | |   |   |         |               | | |   |   |       |               |   |                   | |     | |           |               |   |   | |             |           | |     |       |   |   | | | 
 | |   +---|-------------------------|---|---|-------------------------------|-+               +-----+ +-|-----------------------------|-------|---------------|-----------|-|-----+       |   |   | | | 
 | |       |         |               | | |   |   |       |               |   | |               | | | | | | |           |               |   |   | |             |           | |             |   |   | | | 
 | | +---+ | +-+     |               | | |   |   |       |       +-----------|-+               | +-|-----|---------------+             |   |   | |             |           | |             |   |   | | | 
 | | |   | | | |     |               | | |   |   |       |       |       |   |                 |   | | | | |           | |             |   |   | |             |           | |             |   |   | | | 
 | | |   | | | |     |     +---+     | | |   |   |       |       |       |   |       +---------|---|---|-|---------------|-----------------|---|-|-------------|-------------|---------+ +-|-+ |   | | | 
 | | |   | | | |     |     |   |     | | |   |   |       |       |       |   |       |         |   | | | | |           | |             |   |   | |             |           | |         | | | | |   | | | 
 | | +-+ | | | |     |     |   | +-+ | | |   |   |       |       |       |   |       |         |   | | | | |           | |             |   |   | |             |           | +-----------+ | | |   | | | 
 | |   | | | | |     |     |   | | | | | |   |   |       |       |       |   |       |         |   | | | | |           | |             |   |   | |             |           |           |   | | |   | | | 
 | |   +-----|-|-+   |     |   | +-|-|-|-------+ |       |       | +---+ |   |       |         |   | | +-----------------------+       |   |   | |             |           |           |   | | |   | | | 
 | |     | | | | |   |     |   |   | | | |   | | |       |       | |   | |   |       |         |   | |   | |           | |     |       |   |   | |             |           |           |   | | |   | | | 
 | |     | | | +-|---------|---|---|-|-|-|---|---|---+   |       | |   | |   |       |         |   | |   | |           | |     |       |   |   | |             |           |           |   | | |   | | | 
 | |     | | |   |   |     |   |   | | | |   | | |   |   |       | |   | |   |       |         |   | |   | |           | |     |       |   |   | |             |           |           |   | | |   | | | 
 | |     | | |   |   |     |   | +-+ | | +-----|-|-------|-------------|-----|-----------------|---|-|-----|-----------|-|-----|-------|-----------------------------------|---------------|---------+ | 
 | |     | | |   |   |     |   | |   | |     | | |   |   |       | |   | |   |       |         |   | |   | |           | |     |       |   |   | |             |           |           |   | | |   |   | 
 | | +-----|-|---|-------------|-|-------------------|-------------|---|-|-----------|---------|---------|-----------------------------+   | +-|---------------|-+     +---------------|---|-|-------+ | 
 | | |   | | |   |   |     |   | |   | |     | | |   |   |       | |   | |   |       |         |   | |   | |           | |     |           | | | |             | |     |   |           |   | | |   | | | 
 | +-|-----|-|-------|-----|-----|-+ | | +-----|-|-------|---------------------------+         |   | |   | |           | |     |           | | | |             | |     |   |           +-----|-+   | | | 
 |   |   | | |   |   |     |   | | | | | |   | | |   |   |       | |   | |   |                 |   | |   | |           | |     |           | | | |             | |     |   |               | |     | | | 
 |   |   | | |   |   |     |   | | | | | |   | | |   |   |       | |   | |   |         +------I|---|-------|-----------|-|---------------------|---------------|-------|---|-+         +-------+   | | | 
 |   |   | | |   |   |     |   | | | | | |   | | |   |   |       | |   | |   |         |       |   | |   | |           | |     |           | | | |             | |     |   | |         |   | | |   | | | 
 |   |   | | |   |   |     |   +-|---|-|-|-----+ |   |   |       | |   | |   |         |       |   | |   | |       +---|-------|----Z------------|-------------|-----------|-----------|-+ | | |   | | | 
 |   |   | | |   |   |     |     | | | | |   |   |   |   |       | |   | |   |         |       |   | |   | |       |   | |     |           | | | |             | |     |   | |         | | | | |   | | | 
 |   |   +-|---------------|-----|---|-|-----|---+   |   |       | |   | |   |         |       |   | |   | |       |   | |     |     +-----------|-------------|-------------|-+       | | | | |   | | | 
 |   |     | |   |   |     |     | | | | |   |       |   |       | |   | |   |         |       |   | |   | |       |   | |     |     |     | | | |             | |     |   | | |       | | | | |   | | | 
 |   |     | |   |   |     |     +---|-|-----------+ | +-|-------+ |   | +-------------|-------|---|-----|---------|---|-|-------------------|-|---------------|-------|-----+ |       | | | | |   | | | 
 |   |     | |   |   |     |       | | | |   |     | | | |         |   |     |         |       |   | |   | |       |   | |     |     |     | | | |             | |     |   |   |       | | | | |   | | | 
 |   |     | |   |   |     |       | | | |   |     | | | |       +-|---|---------------|-------|---|-------|-------|---|-----------+ +---------------------------+     |   |   |     +-|---|-|-|-+ | | | 
 |   |     | |   |   |     |       | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   | |     |   |       | | | |             |       |   |   |     | | | | | | | | | | 
 |   |     | |   |   |     |       | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   | |     |   |       | | | |             |       |   |   |     | | | | | | | | | | 
 |   |     | |   |   |     |       | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   | |     |   |       | | | |             |       |   |   |     | | | | | | | | | | 
 |   |     | |   |   |     | +-----|---|-|---------|-|-|---------|-----------|---------|-------------|-------------------+     |   |       | | | |             |       |   |   |     | | | | | | | | | | 
 |   |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       |   |       | | | |             |       |   |   |     | | | | | | | | | | 
 |   |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       | +-|-----+ | | | |             | +-------------|-------|-|-|-+ | | | | | 
 |   |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       | | |     | | | | |             | |     |   |   |     | | | |   | | | | | 
 +---------|-----|---------|-|-----|-|-|-------------------------|-|---------|---------|-----------|-|---|---------|---|-------|-------------|-|-|---------+   | |     |   |   |     | | | |   | | | | | 
     |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       | | |     | | | | |         |   | |     |   |   |     | | | |   | | | | | 
     |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       | | |     | | | | |         |   | |     |   |   +-+   | | | |   | | | | | 
     |     | |   |   |     | |     | | | |   |     | | | |       | |   |     |         |       |   | |   | |       |   |       | | |     | | | | |         |   | |     |   |     |   | | | |   | | | | | 
     |     | |   |   |     | |     | +-|-|---|-------|-----------------------|---------------------|-+   | |       |   |       | | |     | | | | |         |   | |     |   |     |   | | | |   | | | | | 
     |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |       | M |     | | | | |         |   | |     |   |     |   | | | |   | | | | | 
 +---|-------|---|-----------------|---|-|---|-----------|-------------------|---------------------|-----|---------|---|-------|-|-|-----------+ |         |   | |     |   |     |   | | | |   | | | | | 
 |   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |       | | |     | | |   |         |   | |     |   |     |   | | | |   | | | | | 
 |   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |       | | |     | | |   |         |   | |     |   |     |   | | | |   | | | | | 
 |   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |       | | |     | | |   |         |   | |     |   |     |   | | | |   | | | | | 
 |   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |       +-|-----+ | | |   |         |   | |     |   |     +---+ | | |   | | | | | 
 |   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |         | |   | | | |   |         |   | |     |   |           | | |   | | | | | 
 |   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |         | |   | | | |   |         |   | |     |   |           | | |   | | | | | 
 |   |     | |   |   |     | |     |   | |   |     | | | |       | |   |     |         |       |   |     | |       |   |         | |   | | | |   |         |   | |     |   |           | | |   | | | | | 
 |   |     | |   |   |     | |     |   | |   |     | | | +-------|---------------------|-+     |   |     | |       |   |         | |   | | | |   |         |   | +-+ +-------------------|-+   | | | | | 
 |   |     | |   |   |     | |     |   | |   |     | | |         | |   |     |         | |     |   |     | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     | | | | | 
 |   +-+   | |   |   |     | | +-----+ | |   |     | | |       +-|-----------|---------------------|-----------------------------|-------|-|-----|-------------|-------|-----------------------|-+ | | | 
 |     |   | |   |   |     | | |   | | | |   |     | | |       | | |   |     |         | |     |   |     | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     |   | | | 
 |   +-|-----|-------|-----|---|-----|-|-----|---------|-----+ | | |   |     |   +-----|-|-----|---|-+   | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     |   | | | 
 |   | |   | |   |   |     | | |   | | | |   |     | | |     | | | |   |     |   |     | |     |   | |   | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     |   | | | 
 |   | +---+ |   |   | +---+ | |   | | | |   | +---|---------|-|---|---------|---+     | |     |   | |   | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     |   | | | 
 |   |       |   |   | |     | |   | | | |   | |   | | |     | | | |   |     |         | |     |   | |   | |       |   |         | |   | | | |   |         |   |   | | |   |           | |     |   | | | 
 |   |       |   |   | |     | | +---|---|-----|-----|-+     | | | |   |     |         | |     |   | |   | |       |   |         | |   | | +-|---|---------|-----------------------------------|---+ | | 
 |   |       |   |   | |     | | | | | | |   | |   | |       | | | |   |     |         | |     |   | |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |     | | 
 | +-----------------|-------|-----|---------------|-|-------|---|-----------+   +-----|-+     |   | |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |     | | 
 | | |       |   |   | |     | | | | | | |   | |   | |       | | | |   |         |     |       |   | |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |     | | 
 | | |   +---|---+   | |     | | | | | | |   | |   | |       | | | |   |         |     |       |   | |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |     | | 
 | | |   |   |       | |     | | | | | | |   | |   | |       | | | |   |         |     |       |   | |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |     | | 
 | | |   | +-|-----------------|-|---|---+   | |   | |       | | | |   |         |     |       |   +-------|-------|-------------|-|-----|-------|---------|---------|-----|-----------|-----------+ | | 
 | | |   | | |       | |     | | | | | |     | |   | |       | | | |   |         |     |       |     |   | |       |   |         | |   | |   |   |         |   |   | | |   |           | |     |   | | | 
 | | | +-|-|-|-------|-|-----|-|-|---|-|-----------+ |       | | | |   |       +-------|-------|---------|---------|-----+       | | +-|-+   |   | +---+   |   |   | | |   |           | |     |   | | | 
 | | | | | | |       | |     | | | | | |     | |     |       | | | |   |       | |     |       |     |   | |       |   | |       | | | |     |   | |   |   |   |   | | |   |           | |     |   | | | 
 | | | | | | |     +-|-|-----|-----|-|-------|-------|-------------------------+ |     |       |     |   | |       |   | +---------|-----------+ | |   |   |   |   | | |   |           | |     |   | | | 
 | | | | | | |     | | |     | | | | | |     | |     |       | | | |   |         |     |       |     |   | |       |   |         | | | |     | | | |   |   |   |   | | |   |           | |     |   | | | 
 | | | +---|-------+ | | +-+ | | | | | |     | |     |       | | +-|-------------|-------------|---------|---------+   | +-------|---|-------|---|---------|-----------------------------|-----+   | | | 
 | | |   | | |       | | | | | | | | | |     | |     |       | |   |   |         |     |       |     |   | |           | |       | | | |     | | | |   |   |   |   | | |   |           | |         | | | 
 | | |   | | |       | | +-|-|-+ +-|---|-------|-----|---+   | |   | +-----------|-----|-------------|---|-|-----------------------|-|---------------------|---|-------|---------------|-|-------+ | | | 
 | | |   | | |       | |   | |     | | |     | |     |   |   | |   | | |         |     |       |     |   | |           | |       | | | |     | | | |   |   |   |   | | |   |           | |       | | | | 
 | | |   | | |       | | +---|-+   | | |     | |     | +-----|-|---|-|-----------|-------+     |     |   | |           | |       | | | |     | | | |   |   |   |   | | |   |           | |       | | | | 
 | | |   | | |       | | | | | |   | | |     | |     | | |   | |   | | |         |     | |     |     |   | |           | |       | | | |     | | | |   |   |   |   | | |   |           | |       | | | | 
 | | |   | | |       | | | | | | +-+ | |     | |     | +-----|-----|-+ |         |     | |     |     |   | |           | |     +---|-|-|-----+ | | |   +---|-------|-------|-----------|---+     | | | | 
 | | |   | | |       | | | | | | |   | |     | |     |   |   | |   |   |         |     | |     |     |   | |           | |     | | | | |       | | |       |   |   | | |   |           | | |     | | | | 
 | | |   | | |       | | | | | | |   | |     | |     |   |   | |   |   |         |     | |     |     |   | |           | |     | | | | |       | | |       |   |   | | |   |           | | |     | | +-+ 
 | | |   | | |       | | | | | | |   | |     | |     |   |   | |   |   |         |     | |     |     |   | |           | |     | | | | |       | | |       |   |   | | |   |           | | |     | |     
 | | |   | | |       | +---|-|-|-------|-------|-------------|-|-----------------|-------------------+   | |           | |     | | | | |     +-|-|-|-------|-------------------------------------|-----+ 
 | | |   | | |       |   | | | | |   | |     | |     |   |   | |   |   |         |     | |     |         | |           | |     | | | | |     | | | |       |   |   | | |   |           | | |     | |   | 
 | | |   | | |     +-|-------------+ O | +---|-|---------|-+ | |   |   |         |     | |     |         | |           | |     | | | | |     | | | |     +-+   | +-|-|-----------+     | | |     | | +-+ 
 | | |   | | |     | |   | | | | | |   | |   | |     |   | | | |   |   |         |     | |     |         | |           | |     | | | | |     | | | |     |     | | | | |   |     |     | | |     | | |   
 | | |   | +-|-------|---|-------|-|---|-------------|---|-|-------|-------------------|-|-----|---------+ |           | |     | | | | |     | | | |     |     | | | | |   |     |     | | |     | | |   
 | | |   |   |     | |   | | | | | |   | |   | |     |   | | | |   |   |         |     | |     |           |           | |     | | | | |     | | | |     |     | | | | |   |     |     | | |     | | |   
 | | |   | +-|-----|-----|-|---|---|---|-----+ |     |   | +-------|-+ |         |     | |     |           |   +---------|-------|-|---|-----|-|-+ |     |     | | | | |   |     |     | | |     | | |   
 | | |   | | |     | |   | | | | | |   | |     |     |   |   | |   | | |         |     | |     |           |   |       | |     | | | | |     | |   |     |     | | | | |   |     |     | | |     | | |   
 | | |   | | |     | |   | | | | | | +---+     |     |   |   +-|-----|-|---------|-------------------------------------|---------|---|-------|-----|---+ |     | | | | |   |     |     | | |     | | |   
 | | |   | | |     | |   | | | | | | | |       |     |   |     |   | | |         |     | |     |           |   |       | |     | | | | |     | |   |   | |     | | | | |   |     |     | | |     | | |   
 | | |   | | |     | | +-|-|---|---|-|-|-------------|---------------|-----------------|-|-----|-----------|---|-------|-------+ | | | |     | |   |   | |     | | | | |   |     |     | | |     | | |   
 | | |   | | |     | | | | | | | | | | |       |     |   |     |   | | |         |     | |     |           |   |       | |       | | | |     | |   |   | |     | | | | |   |     |     | | |     | | |   
 | | | +-------------|-|-----|---|-|---|-------------|---|---+ |   | | |         |     | |     |           |   +-------|-----------|-|-------|-|---|-----|-----|-+ | | |   |     |     | | |     | | |   
 | | | | | | |     | | | | | | | | | | |       |     |   |   | |   | | |         |     | |     |           |           | |       | | | |     | |   |   | |     |   | | |   |     |     | | |     | | |   
 +-|-+ | | | |     | | | | | | | | | | |       |     |   +---|-|---|-|-|---------|-----|-------|-------------------------------------|---------|---------------|-----|-|---------------|---------+ | |   
   |   | | | |     | | | | | | | | | | |       |     |       | |   | | |         |     | |     |           |           | |       | | | |     | |   |   | |     |   | | |   |     |     | | |       | |   
   |   | | | |     | | | | | | | | | | |       |   +-|-------------|-|-----------|-------------|---------------------------------|---|-|-----------------------|-----|-----------------|---+       | |   
   |   | | | |     | | | | | | | | | | |       |   | |       | |   | | |         |     | |     |           |           | |       | | | |     | |   |   | |     |   | | |   |     |     | |         | |   
   |   | | | |     | | | | | | | | +-|-|-------|---|-|-------------|-------------|-------------------------------------+ |     +-|---|-------|-----|-----------|---+ | |   |     |     | |         | |   
   |   | | | |     | | | | | | | |   | |       |   | |       | |   | | |         |     | |     |           |             |     | | | | |     | |   |   | |     |     | |   |     |     | |         | |   
   |   | | | |     | | | | | | | |   | | +-------+ | | +-----|-----+ | |         |     | |     |           |             |     | | | | |     | +--N|-----|-----|-----|---+ |     +-------|-+       | |   
   |   | | | |     | | | | | | | |   | | |     | | | | |     | |     | |         |     | |     |           |             |     | | | | |     |     |   | |     |     | | | |           | | |       | |   
   | +-+ | | |     | | +---------|-----|-|-------+ | | |     +-|---+ | |         |     +-|-----|-----------|---------------------|---|-------|-----|-----------|-----|-+ | |           | | |       | |   
   | |   | | |     | |   | | | | |   | | |     |   | | |       |   | | |         |       |     |           |             |     | | | | |     |     |   | |     |     |   | |           | | |       | |   
   | | +---|-------|-|---|-|---------|-|-------+   | | |     +-------|-|-----------------|-----|-----------|-------------|-------------|-------+   |   | |     |     |   | |           | | |       | |   
   | | | | | |     | |   | | | | |   | | |         | | |     | |   | | |         |       |     |           |             |     | | | | |     | |   |   | |     |     |   | |           | | |       | |   
   | | | | | |     | |   | +-|-------+ | |         | | |     | |   | | |         |       |     |           |             |     | | | | |     | |   |   | |     |     |   | |           | | |       | |   
   | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |       |     |           |             |     | | | | |     | |   |   | |     |     |   | |           | | |       | |   
   | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |       |     |           |             |     | | | | +-------|---|---|-|-----------|-----|-----------|---|---+   | |   
   | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |       |     |           |             |     | | | |       | |   |   | |     |     |   | |           | | |   |   | |   
   | | | | | |     | +-------|-|-------|-|-------------------|-|-------|-------------------------------------------------|-----|-|-----------|-|---|-----|-----------|---|-|-----------+ | |   |   | |   
   | | | | | |     |     |   | | |     | |         | | |     | |   | | |         |       |     |           |             |     | | | |       | |   |   | |     |     |   | |             | |   |   | |   
   | | | | | |     | +---|-------|-------------------|-|-------|---|-|-----------------+ |     |           |             | +---+ | | |       | |   |   | |     |     |   | |             | |   |   | |   
   | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |     | |     |           |             | |     | | |       | |   |   | |     |     |   | |             | |   |   | |   
   | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |     | |     |           |             | |     | | |       | |   |   | |     |     |   | |             | |   |   | |   
   | | | | | |     | |   |   | | |     | |         | | |     | |   | | |         |     | |     |           |             | |     | | |       | |   |   | |     |     |   | |             | |   |   | |   
   | | | | | |     | |   |   | | |   +---|-----+   | | |     | |   | | |         |     | |     |           |             | |     | | +-------|-|---|-----|-----------|-------------------|-----+   | |   
   | | | | | |     | |   |   | | |   | | |     |   | | |     | |   | | |         |     | |     |           |             | |     | |         | |   |   | |     |     |   | |             | |       | |   
   | | | +-|-----------------|-+ |   | | |     |   | | |     | |   | | |         |     | |     |           |             | |     | |         | |   |   | +-----|-----|-+ | |   +-+       | |       | |   
   | | |   | |     | |   |   |   |   | | |     |   | | |     | |   | | |         |     | |     |           |             | |     | |         | |   |   |       |     | | | |   | |       | |       | |   
   +-------|-|-----|-|---|---|---------|-|-----|---|---|-----|-|---|---|---------------|-------|-----------|-------------|-------------------|-----------------------|-|-|-----|---------|-|---------|-+ 
     | |   | |     | |   |   |   |   | | |     |   | | |     | |   | | |         |     | |     |           |             | |     | |         | |   |   |       |     | | | |   | |       | |       | | | 
     | |   | |     | |   |   |   |   | | |     |   | | |   +-|-|-----|-|---------|-------|-------------------------------|-|-----|-----------------|---------------------|-----|-+       | |       | | | 
     | |   | |     | |   |   |   |   | | |     |   | | |   | | |   | | |         |     | |     |           |             | |     | |         | |   |   |       |     | | | |   |         | |       | | | 
     | |   +---------------------|---|-------------|---|---|-|-|-+ +-+ |         |     | |     |           | +-------------------------------|---------|---+   |     | | | |   |         | |       | | | 
     | |     |     | |   |   |   |   | | |     |   | | |   | | | |     |         |     | |     |           | |           | |     | |         | |   |   |   |   |     | | | |   |         | |       | | | 
     | |     |     | |   |   |   +---|---------|-----|-|---|-+ | |     +---------|-----|---------+         | |           | |   +-|-------+   | |   |   |   |   |     | | | |   |         | |       | | | 
     | |     J     | |   |   |       | | |     |   | | |   |   | |               |     | |     | |         | |           | |   | | |     |   | |   |   |   |   |     | | | |   |         | |       | | | 
     +---+   |     | |   |   |       | | |     |   | | |   |   | |               |     | |     | |         +-------------------|---------|-------------|---|---------|-|-------------+   | |       | | | 
       | |   |     | |   |   |       | | |     |   | | |   |   | |               |     | |     | |           |           | |   | | |     |   | |   |   |   |   |     | | | |   |     |   | |       | | | 
       | |   |     | |   |   |       | | |     | +-|-|--C--------+               |     | |     | |           |           | |   | | |     |   | |   |   |   |   |     | | | |   |     |   | |       | | | 
       | |   |     | |   |   |       | | |     | | | | |   |   |                 |     | |     | |           |           | |   | | |     |   | |   |   |   |   |     | | | |   |     |   | |       | | | 
     +-------------------|---------------|---------|-|-|---------------------------------|-----|-|-------------------------------|-|-----|-------------|-------------|---|-----|-----|---|-----------+ | 
     | | |   |     | |   |   |       | | |     | | | | |   |   |                 |     | |     | |           |           | |   | | |     |   | |   |   |   |   |     | | | |   |     |   | |       |   | 
     | | | +-------------|-----------------------|-|-|-|-------|---------+       |     | +-----|-------------|-------------|---|-------------|-|-+ |   |   |   |     | | | |   |     |   | |       |   | 
     | | | | |     | |   |   |       | | |     | | | | |   |   |         |       |     |       | |           |           | |   | | |     |   | | | |   |   |   |     | | | |   |     |   | |       |   | 
     | | | | |     | |   |   |       | | |     | | +-------|---|---------|---+   |     |       | |           +-------------------|-|-----------|-----------|---------+ | | |   |     |   | |       |   | 
     | | | | |     | |   |   |       | | |     | |   | |   |   |         |   |   |     |       | |                       | |   | | |     |   | | | |   |   |   |       | | |   |     |   | |       |   | 
     | | | | |     | | +---+ |       | | |     | |   | |   |   +---+     |   +---|-----------------------------------------|-+ | | |     |   | | | |   |   |   |       | | |   | +-------|-----------+ | 
     | | | | |     | | | | | |       | | |     | |   | |   |       |     |       |     |       | |                       | | | | | |     |   | | | |   |   |   |       | | |   | |   |   | |       | | | 
     | | | | |     | | | | | +-+     | | |     | |   +-|---|-------|-----|-------|---------------|-----------------------|---|-+ | |     |   | | | |   |   |   |       | | |   | |   |   | |       | | | 
     | | | | |     | | | | |   |     | | |     | |     |   |       |     |       |     |       | |                       | | |   | |     |   | | | |   |   |   |       | | |   | |   |   | |       | | | 
     | | | | |     | | | | | +-|-----------------------------------------+       |     |       | |                       | +-|-+ | |     |   +-----+   | +-----|-----------|---------|-----+       | | | 
     | | | | |     | | | | | | |     | | |     | |     |   |       |             |     |       | |                       |   | | | |     |     | |     | | |   |       | | |   | |   |   |         | | | 
     | | | | |     | | | | | | |     | | |     | |     |   |   +-------------------------------|---------------+         |   +-|-----------------|-----|-----------------|-|-----|-------------------+ | 
     | | | | |     | | | | | | |     | | |     | |     |   |   |   |             |     |       | |             |         |     | | |     |     | |     | | |   |       | | |   | |   |   |         |   | 
   +-+ | | | +-----|-----------+     | | |     +-|-----|---|---|-----------------|-------------|-|-----------------------+ +---|---+     |     | |     | | |   |       | | |   | |   |   |         |   | 
   |   | | |       | | | | | |       | | |       |     |   |   |   |             |     |       | |             |           |   | |       |     | |     | | |   |       | | |   | |   |   |         |   | 
   |   | | |       | | | | | |       | | |       |     |   +-+ |   |           +-|-----------------------------|-----------------|-------------|-------|---------------|---|---+ |   |   |         |   | 
   |   | | |       | | | | | |       | | |       |     |     | |   |           | |     |       | |             |           |   | |       |     | |     | | |   |       | | |     |   |   |         |   | 
 +-|---------------|-|---|-|---------|---+       |   +-------|-------------------|-------+     | | +---+       |           |   | |       |     | |     | +-------------+ | |     |   |   |         |   | 
 | |   | | |       | | | | | |       | |         |   | |     | |   |           | |     | |     | | |   |       |           |   | |       |     | |     |   |   |         | |     |   |   |         |   | 
 +-----|---|-+     | | | | | |       | |         |   | |     | |   +-------------|-------------|---|---|-------|---------+ |   | |       |     | |     |   |   |         | |     |   |   |         |   | 
   |   | | | |     | | | | | |       | |         |   | |     | |               | |     | |     | | |   |       |         | |   | |       |     | |     |   |   |         | |     |   |   |         |   | 
   |   | | | |     | | | | | |       | |         |   | |     | |             +---|-------|-------|-|---|-------|-----------|---|---------------------------|---|-----------|---------|---|-----------+ | 
   |   | | | |     | | | | | |       | |         |   | |     | |             | | |     | |     | | |   |       |         | |   | |       |     | |     |   |   |         | |     |   |   |         | | | 
   |   | | | +-------+ | | | +-------|-|-------------|-|-----+ |             | | |     | +-----|-|-|-----------------------|---|---------|---+ | |     |   |   |         | |     |   |   |         | | | 
   |   | | |       |   | | |         | |         |   | |       |             | | |     |       | | |   |       |         | |   | |       |   | | |     |   |   |         | |     |   |   |         | | | 
   |   | +---------|-+ | | |       +-+ |         |   | +-------|-------------|-|-------|---------------------------------|-----|-|-+     |   | | |     |   |   |         | |     |   |   |         | | | 
   |   |   |       | | | | |       |   |         |   |         |             | | |     |       | | |   |       |         | |   | | |     |   | | |     |   |   |         | |     |   |   |         | | | 
 +-+ +-+ +-----------|-+ | |       |   |         |   |         |             | | +-------------|-+ |   |       |         | |   | | |     |   | | |     |   |   |     +---|-|-----|-------+         | | | 
 |   |   | |       | |   | |       |   |         |   |         |             | |       |       |   |   |       |         | |   | | |     |   | | |     |   |   S     |   | |     |   |             | | | 
 | +-+   | |       | |   | |       |   |         |   |         | +-----------------------------|---|-----------+         | +-------|-----|-----|-+     |   |   |     |   | |     |   |             | | | 
 | |     | |       | |   | |       |   |         |   |         | |           | |       |       |   |   |                 |     | | |     |   | |       |   |   |     |   | |     |   |             | | | 
 +-+     | |       | |   | |       |   |         |   |         | |           | |       +-------|-------|-----------------|-----+ | +-----|-----|-------+   |   |     |   | |     |   |     +-------|-+ | 
         | |       | |   | |       |   |         |   |         | |           | |               |   |   |                 |       |       |   | |           |   |     |   | |     |   |     |       |   | 
         | |       | |   | |       |   |         |   |         | |           +-----------------+   |   +-----------------|---------------------|-----------|---------|-----|-----+   |     |       |   | 
         | |       | |   | |       |   |         |   |         | |             |                   |                     |       |       |   | |           |   |     |   | |         |     |       |   | 
         | |       | +-------------|---|--U--------------------|-+             |     +-------------|-------------------------------------------------------|---+     |   | |         |     |       |   | 
         | |       |     | |       |   |         |   |         |               |     |             |                     |       |       |   | |           |         |   | |         |     |       |   | 
         | |       |     | |       |   |         |   |         |               |     +-------------|-----------------------------|-----------------------------------------|---------+     |     +-|-+ | 
         | |       |     | |       |   |         |   |         |               |                   |                     |       |       |   | |           |         |   | |               |     | | | | 
     +---+ +-------|-------|-------|-----------------|---------------------------------------------|-------------------------------------------|---------------------|---|-|---------------|-----+ | | | 
     |             |     | |       |   |         |   |         |               |                   |                     |       |       |   | |           |         |   | |               |       | | | 
     |             +-----|-+       |   +---------+   |         |               |                   |         +-----------+       |       |   | |           +---------+   | |               |       | | | 
     |                   |         |                 |         |               |                   |         |                   |       |   | |                         | |               |       | | | 
     |                   |         |                 +-------------------------|-------------------|---------|---------------------------|---------------------------------+               |   +-----+ | 
     |                   |         |                           |               |                   |         |                   |       |   | |                         |                 |   |   |   | 
     |                   |         |                           +---------------------------------------------+                   |       |   +---------------------------+                 +---+   |   | 
     |                   |         |                                           |                   |                             |       |     |                                                   |   | 
     +-------------------+         +----------------------------------------T------------------------------------------------------------------|-------------------------------------------------+ |   | 
                                                                               |                   |                             |       |     |                                                 | |   | 
                                                                               +-------------------|-------------------------------+     |     |                                                 +-|---+ 
                                                                                                   |                             | |     |     |                                                   |     
                                                                                                   +-----------------------------+ +-----+     +---------------------------------------------------+     
                                                                                                                                                                                                         """
--}